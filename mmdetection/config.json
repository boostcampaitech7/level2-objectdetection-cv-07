{
    "checkpoint_config": {
        "max_keep_ckpts": 3,
        "interval": 1
    },
    "log_config": {
        "interval": 50,
        "hooks": [
            {
                "type": "TextLoggerHook"
            }
        ]
    },
    "custom_hooks": [
        {
            "type": "NumClassCheckHook"
        }
    ],
    "dist_params": {
        "backend": "nccl"
    },
    "log_level": "INFO",
    "load_from": null,
    "resume_from": null,
    "workflow": [
        [
            "train",
            1
        ]
    ],
    "opencv_num_threads": 0,
    "mp_start_method": "fork",
    "auto_scale_lr": {
        "enable": false,
        "base_batch_size": 64
    },
    "model": {
        "type": "YOLOV3",
        "backbone": {
            "type": "Darknet",
            "depth": 53,
            "out_indices": [
                3,
                4,
                5
            ],
            "init_cfg": {
                "type": "Pretrained",
                "checkpoint": "open-mmlab://darknet53"
            }
        },
        "neck": {
            "type": "YOLOV3Neck",
            "num_scales": 3,
            "in_channels": [
                1024,
                512,
                256
            ],
            "out_channels": [
                512,
                256,
                128
            ]
        },
        "bbox_head": {
            "type": "YOLOV3Head",
            "num_classes": 10,
            "in_channels": [
                512,
                256,
                128
            ],
            "out_channels": [
                1024,
                512,
                256
            ],
            "anchor_generator": {
                "type": "YOLOAnchorGenerator",
                "base_sizes": [
                    [
                        [
                            116,
                            90
                        ],
                        [
                            156,
                            198
                        ],
                        [
                            373,
                            326
                        ]
                    ],
                    [
                        [
                            30,
                            61
                        ],
                        [
                            62,
                            45
                        ],
                        [
                            59,
                            119
                        ]
                    ],
                    [
                        [
                            10,
                            13
                        ],
                        [
                            16,
                            30
                        ],
                        [
                            33,
                            23
                        ]
                    ]
                ],
                "strides": [
                    32,
                    16,
                    8
                ]
            },
            "bbox_coder": {
                "type": "YOLOBBoxCoder"
            },
            "featmap_strides": [
                32,
                16,
                8
            ],
            "loss_cls": {
                "type": "CrossEntropyLoss",
                "use_sigmoid": true,
                "loss_weight": 1.0,
                "reduction": "sum"
            },
            "loss_conf": {
                "type": "CrossEntropyLoss",
                "use_sigmoid": true,
                "loss_weight": 1.0,
                "reduction": "sum"
            },
            "loss_xy": {
                "type": "CrossEntropyLoss",
                "use_sigmoid": true,
                "loss_weight": 2.0,
                "reduction": "sum"
            },
            "loss_wh": {
                "type": "MSELoss",
                "loss_weight": 2.0,
                "reduction": "sum"
            }
        },
        "train_cfg": {
            "assigner": {
                "type": "GridAssigner",
                "pos_iou_thr": 0.5,
                "neg_iou_thr": 0.5,
                "min_pos_iou": 0
            }
        },
        "test_cfg": {
            "nms_pre": 1000,
            "min_bbox_size": 0,
            "score_thr": 0.05,
            "conf_thr": 0.005,
            "nms": {
                "type": "nms",
                "iou_threshold": 0.45
            },
            "max_per_img": 100
        }
    },
    "dataset_type": "CocoDataset",
    "data_root": "data/coco/",
    "img_norm_cfg": {
        "mean": [
            0,
            0,
            0
        ],
        "std": [
            255.0,
            255.0,
            255.0
        ],
        "to_rgb": true
    },
    "train_pipeline": [
        {
            "type": "LoadImageFromFile"
        },
        {
            "type": "LoadAnnotations",
            "with_bbox": true
        },
        {
            "type": "Expand",
            "mean": [
                0,
                0,
                0
            ],
            "to_rgb": true,
            "ratio_range": [
                1,
                2
            ]
        },
        {
            "type": "MinIoURandomCrop",
            "min_ious": [
                0.4,
                0.5,
                0.6,
                0.7,
                0.8,
                0.9
            ],
            "min_crop_size": 0.3
        },
        {
            "type": "Resize",
            "img_scale": [
                320,
                320
            ],
            "keep_ratio": true
        },
        {
            "type": "RandomFlip",
            "flip_ratio": 0.5
        },
        {
            "type": "PhotoMetricDistortion"
        },
        {
            "type": "Normalize",
            "mean": [
                0,
                0,
                0
            ],
            "std": [
                255.0,
                255.0,
                255.0
            ],
            "to_rgb": true
        },
        {
            "type": "Pad",
            "size_divisor": 32
        },
        {
            "type": "DefaultFormatBundle"
        },
        {
            "type": "Collect",
            "keys": [
                "img",
                "gt_bboxes",
                "gt_labels"
            ]
        }
    ],
    "test_pipeline": [
        {
            "type": "LoadImageFromFile"
        },
        {
            "type": "MultiScaleFlipAug",
            "img_scale": [
                320,
                320
            ],
            "flip": false,
            "transforms": [
                {
                    "type": "Resize",
                    "keep_ratio": true
                },
                {
                    "type": "RandomFlip"
                },
                {
                    "type": "Normalize",
                    "mean": [
                        0,
                        0,
                        0
                    ],
                    "std": [
                        255.0,
                        255.0,
                        255.0
                    ],
                    "to_rgb": true
                },
                {
                    "type": "Pad",
                    "size_divisor": 32
                },
                {
                    "type": "ImageToTensor",
                    "keys": [
                        "img"
                    ]
                },
                {
                    "type": "Collect",
                    "keys": [
                        "img"
                    ]
                }
            ]
        }
    ],
    "data": {
        "samples_per_gpu": 4,
        "workers_per_gpu": 4,
        "train": {
            "type": "CocoDataset",
            "ann_file": "/data/ephemeral/home/dataset/train_split.json",
            "img_prefix": "/data/ephemeral/home/dataset",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "LoadAnnotations",
                    "with_bbox": true
                },
                {
                    "type": "Expand",
                    "mean": [
                        0,
                        0,
                        0
                    ],
                    "to_rgb": true,
                    "ratio_range": [
                        1,
                        2
                    ]
                },
                {
                    "type": "MinIoURandomCrop",
                    "min_ious": [
                        0.4,
                        0.5,
                        0.6,
                        0.7,
                        0.8,
                        0.9
                    ],
                    "min_crop_size": 0.3
                },
                {
                    "type": "Resize",
                    "img_scale": [
                        320,
                        320
                    ],
                    "keep_ratio": true
                },
                {
                    "type": "RandomFlip",
                    "flip_ratio": 0.5
                },
                {
                    "type": "PhotoMetricDistortion"
                },
                {
                    "type": "Normalize",
                    "mean": [
                        0,
                        0,
                        0
                    ],
                    "std": [
                        255.0,
                        255.0,
                        255.0
                    ],
                    "to_rgb": true
                },
                {
                    "type": "Pad",
                    "size_divisor": 32
                },
                {
                    "type": "DefaultFormatBundle"
                },
                {
                    "type": "Collect",
                    "keys": [
                        "img",
                        "gt_bboxes",
                        "gt_labels"
                    ]
                }
            ],
            "classes": [
                "General trash",
                "Paper",
                "Paper pack",
                "Metal",
                "Glass",
                "Plastic",
                "Styrofoam",
                "Plastic bag",
                "Battery",
                "Clothing"
            ]
        },
        "val": {
            "type": "CocoDataset",
            "ann_file": "/data/ephemeral/home/dataset/val_split.json",
            "img_prefix": "/data/ephemeral/home/dataset",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "MultiScaleFlipAug",
                    "img_scale": [
                        320,
                        320
                    ],
                    "flip": false,
                    "transforms": [
                        {
                            "type": "Resize",
                            "keep_ratio": true
                        },
                        {
                            "type": "RandomFlip"
                        },
                        {
                            "type": "Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                255.0,
                                255.0,
                                255.0
                            ],
                            "to_rgb": true
                        },
                        {
                            "type": "Pad",
                            "size_divisor": 32
                        },
                        {
                            "type": "ImageToTensor",
                            "keys": [
                                "img"
                            ]
                        },
                        {
                            "type": "Collect",
                            "keys": [
                                "img"
                            ]
                        }
                    ]
                }
            ],
            "classes": [
                "General trash",
                "Paper",
                "Paper pack",
                "Metal",
                "Glass",
                "Plastic",
                "Styrofoam",
                "Plastic bag",
                "Battery",
                "Clothing"
            ]
        },
        "test": {
            "type": "CocoDataset",
            "ann_file": "/data/ephemeral/home/dataset/test.json",
            "img_prefix": "/data/ephemeral/home/dataset",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "MultiScaleFlipAug",
                    "img_scale": [
                        320,
                        320
                    ],
                    "flip": false,
                    "transforms": [
                        {
                            "type": "Resize",
                            "keep_ratio": true
                        },
                        {
                            "type": "RandomFlip"
                        },
                        {
                            "type": "Normalize",
                            "mean": [
                                0,
                                0,
                                0
                            ],
                            "std": [
                                255.0,
                                255.0,
                                255.0
                            ],
                            "to_rgb": true
                        },
                        {
                            "type": "Pad",
                            "size_divisor": 32
                        },
                        {
                            "type": "ImageToTensor",
                            "keys": [
                                "img"
                            ]
                        },
                        {
                            "type": "Collect",
                            "keys": [
                                "img"
                            ]
                        }
                    ]
                }
            ],
            "classes": [
                "General trash",
                "Paper",
                "Paper pack",
                "Metal",
                "Glass",
                "Plastic",
                "Styrofoam",
                "Plastic bag",
                "Battery",
                "Clothing"
            ]
        }
    },
    "optimizer": {
        "type": "SGD",
        "lr": 0.001,
        "momentum": 0.9,
        "weight_decay": 0.0005
    },
    "optimizer_config": {
        "grad_clip": {
            "max_norm": 35,
            "norm_type": 2
        }
    },
    "lr_config": {
        "policy": "step",
        "warmup": "linear",
        "warmup_iters": 2000,
        "warmup_ratio": 0.1,
        "step": [
            218,
            246
        ]
    },
    "runner": {
        "type": "EpochBasedRunner",
        "max_epochs": 15
    },
    "evaluation": {
        "interval": 1,
        "metric": [
            "bbox"
        ]
    },
    "seed": 2022,
    "gpu_ids": [
        0
    ],
    "work_dir": "mmdetection/work_dirs/yolov3_trash",
    "device": "cuda"
}