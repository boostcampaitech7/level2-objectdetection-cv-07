{
    "dataset_type": "CocoDataset",
    "data_root": "data/coco/",
    "img_norm_cfg": {
        "mean": [
            123.675,
            116.28,
            103.53
        ],
        "std": [
            58.395,
            57.12,
            57.375
        ],
        "to_rgb": true
    },
    "train_pipeline": [
        {
            "type": "LoadImageFromFile"
        },
        {
            "type": "LoadAnnotations",
            "with_bbox": true
        },
        {
            "type": "Resize",
            "img_scale": [
                [
                    1333,
                    480
                ],
                [
                    1333,
                    960
                ]
            ],
            "multiscale_mode": "range",
            "keep_ratio": true
        },
        {
            "type": "RandomFlip",
            "flip_ratio": 0.5
        },
        {
            "type": "Normalize",
            "mean": [
                123.675,
                116.28,
                103.53
            ],
            "std": [
                58.395,
                57.12,
                57.375
            ],
            "to_rgb": true
        },
        {
            "type": "Pad",
            "size_divisor": 32
        },
        {
            "type": "DefaultFormatBundle"
        },
        {
            "type": "Collect",
            "keys": [
                "img",
                "gt_bboxes",
                "gt_labels"
            ]
        }
    ],
    "test_pipeline": [
        {
            "type": "LoadImageFromFile"
        },
        {
            "type": "MultiScaleFlipAug",
            "img_scale": [
                1333,
                800
            ],
            "flip": false,
            "transforms": [
                {
                    "type": "Resize",
                    "keep_ratio": true
                },
                {
                    "type": "RandomFlip"
                },
                {
                    "type": "Normalize",
                    "mean": [
                        123.675,
                        116.28,
                        103.53
                    ],
                    "std": [
                        58.395,
                        57.12,
                        57.375
                    ],
                    "to_rgb": true
                },
                {
                    "type": "Pad",
                    "size_divisor": 32
                },
                {
                    "type": "DefaultFormatBundle"
                },
                {
                    "type": "Collect",
                    "keys": [
                        "img"
                    ]
                }
            ]
        }
    ],
    "data": {
        "samples_per_gpu": 4,
        "workers_per_gpu": 2,
        "train": {
            "type": "CocoDataset",
            "ann_file": "/data/ephemeral/home/dataset/train.json",
            "img_prefix": "/data/ephemeral/home/dataset",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "LoadAnnotations",
                    "with_bbox": true
                },
                {
                    "type": "Resize",
                    "img_scale": [
                        [
                            1333,
                            480
                        ],
                        [
                            1333,
                            960
                        ]
                    ],
                    "multiscale_mode": "range",
                    "keep_ratio": true
                },
                {
                    "type": "RandomFlip",
                    "flip_ratio": 0.5
                },
                {
                    "type": "Normalize",
                    "mean": [
                        123.675,
                        116.28,
                        103.53
                    ],
                    "std": [
                        58.395,
                        57.12,
                        57.375
                    ],
                    "to_rgb": true
                },
                {
                    "type": "Pad",
                    "size_divisor": 32
                },
                {
                    "type": "DefaultFormatBundle"
                },
                {
                    "type": "Collect",
                    "keys": [
                        "img",
                        "gt_bboxes",
                        "gt_labels"
                    ]
                }
            ],
            "classes": [
                "General trash",
                "Paper",
                "Paper pack",
                "Metal",
                "Glass",
                "Plastic",
                "Styrofoam",
                "Plastic bag",
                "Battery",
                "Clothing"
            ]
        },
        "val": {
            "type": "CocoDataset",
            "ann_file": "data/coco/annotations/instances_val2017.json",
            "img_prefix": "data/coco/val2017/",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "MultiScaleFlipAug",
                    "img_scale": [
                        1333,
                        800
                    ],
                    "flip": false,
                    "transforms": [
                        {
                            "type": "Resize",
                            "keep_ratio": true
                        },
                        {
                            "type": "RandomFlip"
                        },
                        {
                            "type": "Normalize",
                            "mean": [
                                123.675,
                                116.28,
                                103.53
                            ],
                            "std": [
                                58.395,
                                57.12,
                                57.375
                            ],
                            "to_rgb": true
                        },
                        {
                            "type": "Pad",
                            "size_divisor": 32
                        },
                        {
                            "type": "DefaultFormatBundle"
                        },
                        {
                            "type": "Collect",
                            "keys": [
                                "img"
                            ]
                        }
                    ]
                }
            ]
        },
        "test": {
            "type": "CocoDataset",
            "ann_file": "/data/ephemeral/home/dataset/test.json",
            "img_prefix": "/data/ephemeral/home/dataset",
            "pipeline": [
                {
                    "type": "LoadImageFromFile"
                },
                {
                    "type": "MultiScaleFlipAug",
                    "img_scale": [
                        1333,
                        800
                    ],
                    "flip": false,
                    "transforms": [
                        {
                            "type": "Resize",
                            "keep_ratio": true
                        },
                        {
                            "type": "RandomFlip"
                        },
                        {
                            "type": "Normalize",
                            "mean": [
                                123.675,
                                116.28,
                                103.53
                            ],
                            "std": [
                                58.395,
                                57.12,
                                57.375
                            ],
                            "to_rgb": true
                        },
                        {
                            "type": "Pad",
                            "size_divisor": 32
                        },
                        {
                            "type": "DefaultFormatBundle"
                        },
                        {
                            "type": "Collect",
                            "keys": [
                                "img"
                            ]
                        }
                    ]
                }
            ],
            "classes": [
                "General trash",
                "Paper",
                "Paper pack",
                "Metal",
                "Glass",
                "Plastic",
                "Styrofoam",
                "Plastic bag",
                "Battery",
                "Clothing"
            ]
        }
    },
    "evaluation": {
        "interval": 1,
        "metric": "bbox"
    },
    "optimizer": {
        "type": "SGD",
        "lr": 0.01,
        "momentum": 0.9,
        "weight_decay": 0.0001,
        "paramwise_cfg": {
            "bias_lr_mult": 2.0,
            "bias_decay_mult": 0.0
        }
    },
    "optimizer_config": {
        "grad_clip": {
            "max_norm": 35,
            "norm_type": 2
        }
    },
    "lr_config": {
        "policy": "step",
        "warmup": "linear",
        "warmup_iters": 500,
        "warmup_ratio": 0.1,
        "step": [
            16,
            22
        ]
    },
    "runner": {
        "type": "EpochBasedRunner",
        "max_epochs": 15
    },
    "checkpoint_config": {
        "max_keep_ckpts": 3,
        "interval": 1
    },
    "log_config": {
        "interval": 50,
        "hooks": [
            {
                "type": "TextLoggerHook"
            }
        ]
    },
    "custom_hooks": [
        {
            "type": "NumClassCheckHook"
        }
    ],
    "dist_params": {
        "backend": "nccl"
    },
    "log_level": "INFO",
    "load_from": null,
    "resume_from": null,
    "workflow": [
        [
            "train",
            1
        ]
    ],
    "opencv_num_threads": 0,
    "mp_start_method": "fork",
    "auto_scale_lr": {
        "enable": false,
        "base_batch_size": 16
    },
    "model": {
        "type": "VFNet",
        "backbone": {
            "type": "ResNeXt",
            "depth": 101,
            "num_stages": 4,
            "out_indices": [
                0,
                1,
                2,
                3
            ],
            "frozen_stages": 1,
            "norm_cfg": {
                "type": "BN",
                "requires_grad": true
            },
            "norm_eval": true,
            "style": "pytorch",
            "init_cfg": {
                "type": "Pretrained",
                "checkpoint": "open-mmlab://resnext101_64x4d"
            },
            "dcn": {
                "type": "DCNv2",
                "deform_groups": 1,
                "fallback_on_stride": false
            },
            "stage_with_dcn": [
                false,
                true,
                true,
                true
            ],
            "groups": 64,
            "base_width": 4
        },
        "neck": {
            "type": "FPN",
            "in_channels": [
                256,
                512,
                1024,
                2048
            ],
            "out_channels": 256,
            "start_level": 1,
            "add_extra_convs": "on_output",
            "num_outs": 5,
            "relu_before_extra_convs": true
        },
        "bbox_head": {
            "type": "VFNetHead",
            "num_classes": 10,
            "in_channels": 256,
            "stacked_convs": 3,
            "feat_channels": 256,
            "strides": [
                8,
                16,
                32,
                64,
                128
            ],
            "center_sampling": false,
            "dcn_on_last_conv": true,
            "use_atss": true,
            "use_vfl": true,
            "loss_cls": {
                "type": "VarifocalLoss",
                "use_sigmoid": true,
                "alpha": 0.75,
                "gamma": 2.0,
                "iou_weighted": true,
                "loss_weight": 1.0
            },
            "loss_bbox": {
                "type": "GIoULoss",
                "loss_weight": 1.5
            },
            "loss_bbox_refine": {
                "type": "GIoULoss",
                "loss_weight": 2.0
            }
        },
        "train_cfg": {
            "assigner": {
                "type": "ATSSAssigner",
                "topk": 9
            },
            "allowed_border": -1,
            "pos_weight": -1,
            "debug": false
        },
        "test_cfg": {
            "nms_pre": 1000,
            "min_bbox_size": 0,
            "score_thr": 0.05,
            "nms": {
                "type": "nms",
                "iou_threshold": 0.6
            },
            "max_per_img": 100
        }
    },
    "seed": 2022,
    "gpu_ids": [
        0
    ],
    "work_dir": "mmdetection/work_dirs/vfnet_trash",
    "device": "cuda"
}